
# *************************************************************************************************************************************************
# --------------------------------------------------------------------------------------------------------------------------------------
# Register LDAP
# --------------------------------------------------------------------------------------------------------------------------------------
# *************************************************************************************************************************************************


# --------------------------------------------------------------------------------------------------------------------------------------
# Register LDAP
# --------------------------------------------------------------------------------------------------------------------------------------


# *************************************************************************************************************************************************
# --------------------------------------------------------------------------------------------------------------------------------------
# Get Cluster FQDN
# --------------------------------------------------------------------------------------------------------------------------------------
# *************************************************************************************************************************************************

- name: IMINSTALL -          🌏 Get Cluster FQDN
  shell: |
    CLUSTER_ROUTE=$(oc get routes console -n openshift-console | tail -n 1 2>&1 ) 
    CLUSTER_FQDN=$( echo $CLUSTER_ROUTE | awk '{print $2}')
    echo ${CLUSTER_FQDN##*console.}
  register: CLUSTER_NAME


- name: IMINSTALL -       💾 Set Infrastructure Management Route={{ CLUSTER_NAME.stdout }} 
  set_fact: INFRA_NAME=inframgmtinstall.{{ CLUSTER_NAME.stdout }} 




# Create Infrastructure Management
- name: IMINSTALL -          🚀 Install Infrastructure Management with {{ INFRA_NAME }}
  kubernetes.core.k8s:
    state: present
    template: ./templates/infra-management/1_iminstall.j2

